# å¿«é€Ÿå¼€å§‹æŒ‡å—

## æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼

### 1ï¸âƒ£ è‡ªåŠ¨åˆ’åˆ†æ•°æ®é›† + è®­ç»ƒï¼ˆæ¨èï¼‰

```bash
python train.py train train_labels.csv
```

**é€‚ç”¨åœºæ™¯ï¼š**
- ä½ æœ‰ä¸€ä¸ªåŒ…å«æ‰€æœ‰å›¾ç‰‡çš„æ–‡ä»¶å¤¹ (`train/`)
- ä½ æœ‰ä¸€ä¸ªCSVæ ‡ç­¾æ–‡ä»¶ (`train_labels.csv`)
- éœ€è¦è‡ªåŠ¨åˆ’åˆ†ä¸º train/val/test

**ç¨‹åºä¼šè‡ªåŠ¨ï¼š**
1. è¯»å–å›¾ç‰‡å’Œæ ‡ç­¾
2. æŒ‰ 70:20:10 åˆ’åˆ†æ•°æ®é›†
3. ä¿å­˜åˆ° `model/dataset/`
4. ä½¿ç”¨åˆ’åˆ†åçš„æ•°æ®é›†è®­ç»ƒ
5. ä¿å­˜æ¨¡å‹åˆ° `model/runs/`

---

### 2ï¸âƒ£ ç›´æ¥è®­ç»ƒï¼ˆå·²åˆ’åˆ†æ•°æ®é›†ï¼‰

```bash
python train.py flowerme
```

**é€‚ç”¨åœºæ™¯ï¼š**
- æ•°æ®é›†å·²ç»åˆ’åˆ†å¥½
- ç›®å½•ç»“æ„ï¼š`flowerme/train/`, `flowerme/val/`

**ç¨‹åºä¼šï¼š**
1. éªŒè¯æ•°æ®é›†ç»“æ„
2. ç›´æ¥è®­ç»ƒ
3. ä¿å­˜æ¨¡å‹åˆ° `model/runs/`

---

## æ–‡ä»¶å‡†å¤‡

### æ–¹å¼1: åŸå§‹æ•°æ®ï¼ˆè‡ªåŠ¨åˆ’åˆ†ï¼‰

**ç›®å½•ç»“æ„ï¼š**
```
project/
â”œâ”€â”€ train/              # æ‰€æœ‰åŸå§‹å›¾ç‰‡
â”‚   â”œâ”€â”€ img001.jpg
â”‚   â”œâ”€â”€ img002.jpg
â”‚   â””â”€â”€ ...
â””â”€â”€ train_labels.csv    # æ ‡ç­¾æ–‡ä»¶
```

**CSVæ–‡ä»¶æ ¼å¼ï¼š**
```csv
filename,category_id,chinese_name,english_name
img001.jpg,1,ç«ç‘°,rose
img002.jpg,2,éƒé‡‘é¦™,tulip
img003.jpg,1,ç«ç‘°,rose
```

**è¿è¡Œå‘½ä»¤ï¼š**
```bash
python train.py train train_labels.csv
```

---

### æ–¹å¼2: å·²åˆ’åˆ†æ•°æ®é›†

**ç›®å½•ç»“æ„ï¼š**
```
flowerme/
â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ 1/          # ç±»åˆ«1
â”‚   â”‚   â”œâ”€â”€ img1.jpg
â”‚   â”‚   â””â”€â”€ img2.jpg
â”‚   â”œâ”€â”€ 2/          # ç±»åˆ«2
â”‚   â””â”€â”€ ...
â””â”€â”€ val/
    â”œâ”€â”€ 1/
    â”œâ”€â”€ 2/
    â””â”€â”€ ...
```

**è¿è¡Œå‘½ä»¤ï¼š**
```bash
python train.py flowerme
```

---

## å¸¸ç”¨å‚æ•°

### è°ƒæ•´è®­ç»ƒå‚æ•°
```bash
python train.py train train_labels.csv \
  --epochs 50 \
  --batch 32 \
  --device 0
```

### å¯ç”¨æ··åˆç²¾åº¦ï¼ˆåŠ é€Ÿè®­ç»ƒï¼‰
```bash
python train.py train train_labels.csv --amp --device 0
```

### å¯ç”¨æ•°æ®å¢å¼º
```bash
python train.py train train_labels.csv \
  --erasing 0.2 \
  --hsv_h 0.02 \
  --fliplr 0.5
```

### æŸ¥çœ‹æ‰€æœ‰å‚æ•°
```bash
python train.py --help
```

---

## è¾“å‡ºæ–‡ä»¶

### è‡ªåŠ¨åˆ’åˆ†æ¨¡å¼
```
model/
â”œâ”€â”€ dataset/           # åˆ’åˆ†åçš„æ•°æ®é›†
â”‚   â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ val/
â”‚   â””â”€â”€ test/
â”œâ”€â”€ runs/              # è®­ç»ƒç»“æœ
â”‚   â””â”€â”€ weights/
â”‚       â”œâ”€â”€ best.pt    # æœ€ä½³æ¨¡å‹ â­
â”‚       â””â”€â”€ last.pt    # æœ€åæ¨¡å‹
â””â”€â”€ config.json        # è®­ç»ƒé…ç½®
```

### ç›´æ¥è®­ç»ƒæ¨¡å¼
```
model/
â”œâ”€â”€ runs/              # è®­ç»ƒç»“æœ
â”‚   â””â”€â”€ weights/
â”‚       â”œâ”€â”€ best.pt    # æœ€ä½³æ¨¡å‹ â­
â”‚       â””â”€â”€ last.pt    # æœ€åæ¨¡å‹
â””â”€â”€ config.json        # è®­ç»ƒé…ç½®
```

---

## å…¸å‹å·¥ä½œæµç¨‹

### ç¬¬ä¸€æ¬¡è®­ç»ƒ
```bash
# 1. å‡†å¤‡æ•°æ®
# ç¡®ä¿æœ‰ train/ æ–‡ä»¶å¤¹å’Œ train_labels.csv

# 2. å¼€å§‹è®­ç»ƒ
python train.py train train_labels.csv

# 3. ç­‰å¾…è®­ç»ƒå®Œæˆ
# æ¨¡å‹ä¿å­˜åœ¨ model/runs/weights/best.pt
```

### ç»§ç»­è®­ç»ƒ
```bash
# ä½¿ç”¨ä¸Šæ¬¡åˆ’åˆ†çš„æ•°æ®é›†ç»§ç»­è®­ç»ƒ
python train.py model/dataset --resume model/runs/weights/last.pt
```

### è°ƒæ•´å‚æ•°é‡æ–°è®­ç»ƒ
```bash
# ä½¿ç”¨ä¸åŒçš„è¶…å‚æ•°
python train.py model/dataset \
  --epochs 100 \
  --batch 64 \
  --lr0 0.0005
```

---

## Docker ç¯å¢ƒ

```bash
# è¿›å…¥å®¹å™¨
docker run -it --gpus all \
  -v D:/code/Flower-Recognition:/workspace \
  <image_name> /bin/bash

# å®¹å™¨å†…è®­ç»ƒ
cd /workspace/code/submission/code
python train.py \
  /workspace/code/data/train \
  /workspace/code/data/train_labels.csv
```

---

## æ•…éšœæ’é™¤

### âŒ æ•°æ®é›†ç›®å½•ç»“æ„ä¸æ­£ç¡®
**é—®é¢˜ï¼š** ç¼ºå°‘ train/ æˆ– val/ ç›®å½•

**è§£å†³ï¼š**
- æ–¹å¼1: æä¾› CSV æ–‡ä»¶è‡ªåŠ¨åˆ’åˆ†
- æ–¹å¼2: æ‰‹åŠ¨åˆ›å»ºç›®å½•ç»“æ„

### âŒ CSVæ–‡ä»¶æ‰¾ä¸åˆ°
**é—®é¢˜ï¼š** è·¯å¾„é”™è¯¯

**è§£å†³ï¼š** ä½¿ç”¨ç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹äºè„šæœ¬çš„æ­£ç¡®è·¯å¾„

### âŒ å›¾ç‰‡æ–‡ä»¶ç¼ºå¤±
**é—®é¢˜ï¼š** CSVä¸­çš„æ–‡ä»¶ååœ¨ç›®å½•ä¸­æ‰¾ä¸åˆ°

**è§£å†³ï¼š** æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦åŒ¹é…ï¼Œç¨‹åºä¼šè‡ªåŠ¨è·³è¿‡ç¼ºå¤±æ–‡ä»¶

---

## ä¸‹ä¸€æ­¥

- ğŸ“– æŸ¥çœ‹å®Œæ•´æ–‡æ¡£ï¼š`TRAINING_USAGE.md`
- ğŸ¨ äº†è§£æ•°æ®å¢å¼ºï¼š`AUGMENTATION_USAGE.md`
- ğŸ”§ è‡ªå®šä¹‰é…ç½®ï¼šä¿®æ”¹å‘½ä»¤è¡Œå‚æ•°
- ğŸ“Š æŸ¥çœ‹è®­ç»ƒç»“æœï¼š`model/runs/results.csv`
